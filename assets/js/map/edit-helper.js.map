{"version":3,"sources":["edit-helper.js"],"names":["jQuery","document","ready","$","$table","click","e","preventDefault","start","val","end","errorMsg","match","TsOpenHour","startError","endError","parseInt","replace","pastStartError","create_table","window","alert","find","length","notEmpty","each","defaultTime","index","time","row","tag","i","defaultDays","indexOf","deleteBtn","append","effect","tr","currentStart","before","after","reZebra","on","confirm","deleteConfirm","this","parent","hide","remove","elt","className","removeClass","addClass","attr"],"mappings":"AAMAA,OAAOC,UAAUC,MAAM,SAASC,GAE/B,YAEA,IAAIC,GAASD,EAAE,mBAGfA,GAAE,YAAYE,MAAM,SAASC,GAC5BA,EAAEC,gBACF,IAAIC,GAAQL,EAAE,oBAAoBM,MAC9BC,EAAMP,EAAE,kBAAkBM,MAC1BE,EAAW,EACXH,GAAMI,MAAM,yBACfD,GAAYE,WAAWC,WAAa,MAEjCJ,EAAIE,MAAM,yBACbD,GAAYE,WAAWE,SAAW,MAEhCC,SAASR,EAAMS,QAAQ,IAAK,IAAK,KAAOD,SAASN,EAAIO,QAAQ,IAAK,IAAK,MACzEN,GAAYE,WAAWK,gBAET,IAAZP,EACFQ,EAAaX,EAAOE,GAEpBU,OAAOC,MAAMV,KAKfR,EAAE,oBAAoBE,MAAM,SAASC,GACpCA,EAAEC,iBAECH,EAAOkB,KAAK,YAAYC,OAAS,EACnCF,MAAOR,WAAWW,UAElBrB,EAAEsB,KAAKZ,WAAWa,YAAa,SAASC,EAAOC,GAC7CT,EAAcS,EAAK,GAAIA,EAAK,OAMhC,IAAIT,GAAe,SAASX,EAAOE,GAElC,GAAImB,GAAMzB,EAAOkB,KAAK,YAAYC,OAC9BO,EAAM,MACVA,IAAO,qEAAuEtB,EAAQ,IAAME,EAAM,WAClG,KAAI,GAAIqB,GAAI,EAAGA,EAAI,EAAGA,IAAI,CAEzBD,GAAO,+BAAiCC,EAAI,OAC5CD,GAAO,mBACJC,GAAK,IACPD,GAAO,wBAERA,GAAO,cACPA,GAAO,qBACF,EAAIjB,WAAWmB,YAAYC,QAAQF,KACvCD,GAAO,wBAERA,GAAO,qBACPA,GAAO,iBAERA,GAAO,6CAA+CjB,WAAWqB,UAAY,YAC7EJ,GAAO,QACJD,EAAM,GACRzB,EAAOkB,KAAK,SAASa,OAAOL,GAC5B1B,EAAOkB,KAAK,kBAAkBc,OAAO,eAAiB,MAGtDhC,EAAOkB,KAAK,YAAYG,KAAK,SAASE,EAAOU,GAE5C,GAAIC,GAAenC,EAAEkC,GAAIf,KAAK,YAAYb,MAAMQ,QAAQ,sBAAuB,GAC/E,OAAGD,UAASR,EAAMS,QAAQ,IAAK,IAAK,IAAMD,SAASsB,EAAarB,QAAQ,IAAK,IAAK,KAEjFd,EAAEkC,GAAIE,OAAOT,GACb1B,EAAOkB,KAAK,eAAiBK,EAAQ,KAAKS,OAAO,eAAiB,MAC3D,GACCP,EAAM,GAAKF,GAEnBxB,EAAEkC,GAAIG,MAAMV,GACZ1B,EAAOkB,KAAK,gBAAkBK,EAAQ,GAAK,KAAKS,OAAO,eAAiB,MACjE,OAJF,KAQRK,IAIDrC,GAAOsC,GAAG,QAAS,aAAc,SAASpC,GACzCA,EAAEC,iBACCa,OAAOuB,QAAQ9B,WAAW+B,gBAC5BzC,EAAE0C,MAAMC,OAAO,MAAMA,OAAO,MAAMC,KAAK,eAAiB,IAAM,WAC7D5C,EAAE0C,MAAMG,SACRP,OAOH,IAAIA,GAAU,WACbtC,EAAE,6BAA6BsB,KAAK,SAASE,EAAOsB,GACnD,GAAIC,IAAevB,EAAQ,GAAK,GAAK,EAAK,MAAQ,KAElDxB,GAAE8C,GAAKE,YAAY,OAAOA,YAAY,OAAOC,SAASF,GAEtD/C,EAAE8C,GAAK3B,KAAK,YAAY+B,KAAK,OAAQ,kBAAoB1B,EAAQ,KACjExB,EAAE8C,GAAK3B,KAAK,wBAAwBG,KAAK,SAASM,EAAGzB,GACpDH,EAAEG,GAAG+C,KAAK,OAAQ,aAAetB,EAAI,IAAMJ,EAAQ","file":"../edit-helper.js","sourcesContent":["/*!\n * Admin screen helper for\n */\n\n/*global TsOpenHour:false */\n\njQuery(document).ready(function($){\n\n\t'use strict';\n\n\tvar $table = $('#tsoh-time-table');\n\n\t// Add button\n\t$('#timeadd').click(function(e){\n\t\te.preventDefault();\n\t\tvar start = $('#tsoh-time-start').val();\n\t\tvar end = $('#tsoh-time-end').val();\n\t\tvar errorMsg = \"\";\n\t\tif(!start.match(/^[0-9]{2}:[0-9]{2}$/)){\n\t\t\terrorMsg += TsOpenHour.startError + \"\\n\";\n\t\t}\n\t\tif(!end.match(/^[0-9]{2}:[0-9]{2}$/)){\n\t\t\terrorMsg += TsOpenHour.endError + \"\\n\";\n\t\t}\n\t\tif(parseInt(start.replace(\":\", \"\"), 10) >= parseInt(end.replace(\":\", \"\"), 10)){\n\t\t\terrorMsg += TsOpenHour.pastStartError;\n\t\t}\n\t\tif(errorMsg == \"\"){\n\t\t\tcreate_table(start, end);\n\t\t}else{\n\t\t\twindow.alert(errorMsg);\n\t\t}\n\t});\n\t\n\t// Default Button\n\t$('#timeadd-default').click(function(e){\n\t\te.preventDefault();\n\t\t// Check if table exists\n\t\tif($table.find('tbody tr').length > 0){\n\t\t\talert( TsOpenHour.notEmpty );\n\t\t}else{\n\t\t\t$.each(TsOpenHour.defaultTime, function(index, time){\n\t\t\t  create_table( time[0], time[1] );\n\t\t\t});\n\t\t}\n\t});\n\n\t// Add table\n\tvar create_table = function(start, end){\n\t\t// Count table line\n\t\tvar row = $table.find('tbody tr').length;\n\t\tvar tag = '<tr>';\n\t\ttag += '<th scope=\"row\"><input name=\"tsoh_open_hour[]\" type=\"text\" value=\"' + start + \"-\" + end + '\" /></th>';\n\t\tfor(var i = 0; i < 7; i++){\n\t\t\tvar checked = (i < 5) ? ' checked=\"checked\"' : \"\";\n\t\t\ttag += '<td><select name=\"tsoh_date_' + i + '[]\">';\n\t\t\ttag += '<option value=\"\"';\n\t\t\tif(i >= 5){\n\t\t\t\ttag += ' selected=\"selected\"';\n\t\t\t}\n\t\t\ttag += '>-</option>';\n\t\t\ttag += '<option value=\"0\"';\n\t\t\tif( -1 < TsOpenHour.defaultDays.indexOf(i) ){\n\t\t\t\ttag += ' selected=\"selected\"';\n\t\t\t}\n\t\t\ttag += '>&#x2713;</option>';\n\t\t\ttag += '</select></td>';\n\t\t}\n\t\ttag += '<td><a class=\"delete-time-shift\" href=\"#\">' + TsOpenHour.deleteBtn + '</a></td>';\n\t\ttag += '</tr>';\n\t\tif(row < 1){\n\t\t\t$table.find('tbody').append(tag);\n\t\t\t$table.find('tbody tr:first').effect('highlight', {}, 1000);\n\t\t}else{\n\t\t\t//Find place\n\t\t\t$table.find('tbody tr').each(function(index, tr){\n\t\t\t\t// Get start time\n\t\t\t\tvar currentStart = $(tr).find('th input').val().replace(/-[0-9]{2}:[0-9]{2}$/, \"\");\n\t\t\t\tif(parseInt(start.replace(\":\", \"\"), 10) < parseInt(currentStart.replace(\":\", \"\"), 10)){\n\t\t\t\t\t// Compare time and insert if earlier.\n\t\t\t\t\t$(tr).before(tag);\n\t\t\t\t\t$table.find('tbody tr:eq(' + index + ')').effect('highlight', {}, 1000);\n\t\t\t\t\treturn false;\n\t\t\t\t}else if(row - 1 == index){\n\t\t\t\t\t// no next lien\n\t\t\t\t\t$(tr).after(tag);\n\t\t\t\t\t$table.find('tbody tr:eq(' + (index + 1) + ')').effect('highlight', {}, 1000);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\treZebra();\n\t};\n\t\n\t// delete handler\n\t$table.on('click', 'tbody tr a', function(e){\n\t\te.preventDefault();\n\t\tif(window.confirm(TsOpenHour.deleteConfirm)){\n\t\t\t$(this).parent('td').parent('tr').hide('highlight', {}, 1000, function(){\n\t\t\t\t$(this).remove();\n\t\t\t\treZebra();\n\t\t\t});\n\t\t}\n\t});\n\t\n\t\n\t//ゼブラクラスの振りなおし\n\tvar reZebra = function(){\n\t\t$('#tsoh-time-table tbody tr').each(function(index, elt){\n\t\t\tvar className = ( (index + 1) % 2 == 0) ? 'alt' : 'odd';\n\t\t\t//既存のクラスを削除\n\t\t\t$(elt).removeClass('alt').removeClass('odd').addClass(className);\n\t\t\t//inputタグのname属性を振りなおし\n\t\t\t$(elt).find('th input').attr('name', 'tsoh_open_hour[' + index + ']');\n\t\t\t$(elt).find('input[type=checkbox]').each(function(i, e){\n\t\t\t\t$(e).attr('name', 'tsoh_date_' + i + '[' + index + ']');\n\t\t\t});\n\t\t});\n\t};\n\t\n});\n"]}